# –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Node.js –∏ Fetch API

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–µ—Ä—Å–∏—è–º

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

- **Node.js**: >= 18.0.0 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 18.x –∏–ª–∏ –≤—ã—à–µ)
- **npm**: >= 8.0.0

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

- **Node.js**: >= 18.0.0
- **npm**: >= 8.0.0

## üîß Fetch API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### Node.js >= 18

- ‚úÖ **–ù–∞—Ç–∏–≤–Ω—ã–π fetch API** –¥–æ—Å—Ç—É–ø–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ
- ‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### Node.js < 18

- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–µ–Ω –∑–∞–ø—É—Å–∫ —Å –ø–æ–ª–∏—Ñ–∏–ª–ª–æ–º `node-fetch`
- ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### Node.js < 16

- ‚ùå **–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è**
- ‚ùå –°–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

ROX VPN API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ä—Å–∏—é Node.js –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–∏—Ñ–∏–ª–ª –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:

```javascript
// –õ–æ–≥–∏–∫–∞ –∏–∑ server.js
const nodeVersion = process.version;
const majorVersion = parseInt(nodeVersion.slice(1).split(".")[0], 10);

if (majorVersion < 18) {
  // –î–ª—è Node.js < 18 –∏—Å–ø–æ–ª—å–∑—É–µ–º node-fetch –∫–∞–∫ –ø–æ–ª–∏—Ñ–∏–ª–ª
  const fetch = require("node-fetch");
  global.fetch = fetch;
  console.log(
    `Node.js ${nodeVersion} detected, using node-fetch polyfill for fetch API`,
  );
} else {
  console.log(`Node.js ${nodeVersion} detected, using native fetch API`);
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Node.js

```bash
./check-node-version.sh
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ fetch API

```bash
node test-fetch.js
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
npm install
```

> –î–ª—è Node.js –Ω–∏–∂–µ 18 –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `node-fetch` –∫–∞–∫ –ø–æ–ª–∏—Ñ–∏–ª–ª.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
./check-node-version.sh
```

–í—ã–≤–æ–¥ –¥–ª—è Node.js >= 18:

```
[INFO] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≤–µ—Ä—Å–∏—è Node.js: v18.17.0
[SUCCESS] Node.js –≤–µ—Ä—Å–∏–∏ v18.17.0 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–π fetch API
```

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "fetch is not defined"

**–ü—Ä–∏—á–∏–Ω–∞**: Node.js < 18 –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª–∏—Ñ–∏–ª–ª–∞
**–†–µ—à–µ–Ω–∏–µ**:

```bash
cd backend
npm install
```

### –û—à–∏–±–∫–∞: "Cannot find module 'node-fetch'"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª–∏—Ñ–∏–ª–ª –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
**–†–µ—à–µ–Ω–∏–µ**:

```bash
cd backend
npm install node-fetch@^3.3.2
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ–ª–∏—Ñ–∏–ª–ª–∞

**–ü—Ä–∏—á–∏–Ω–∞**: `node-fetch` —É—Å—Ç—É–ø–∞–µ—Ç –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞—Ç–∏–≤–Ω–æ–º—É API
**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç–µ Node.js –¥–æ –≤–µ—Ä—Å–∏–∏ 18+

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| Node.js –≤–µ—Ä—Å–∏—è | Fetch API | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å   | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è         |
| -------------- | --------- | -------------------- | -------------------- |
| >= 18          | –ù–∞—Ç–∏–≤–Ω—ã–π  | üü¢ –û—Ç–ª–∏—á–Ω–∞—è          | ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è     |
| < 18           | –ü–æ–ª–∏—Ñ–∏–ª–ª  | üü° –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ | ‚ö†Ô∏è –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ |

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Node.js

```bash
# –ò—Å–ø–æ–ª—å–∑—É—è nvm (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
nvm install 18
nvm use 18

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
node --version
./check-node-version.sh
./test-fetch.js
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Node.js Download](https://nodejs.org/)
- [node-fetch Documentation](https://github.com/node-fetch/node-fetch)
- [Fetch API MDN](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)
